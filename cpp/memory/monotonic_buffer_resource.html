<!DOCTYPE html><html lang="en" dir="ltr" class="client-nojs"><!-- Mirrored from en.cppreference.com/w/cpp/memory/monotonic_buffer_resource by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 29 Jan 2025 11:38:20 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->

<title>std::pmr::monotonic_buffer_resource</title>
<meta charset="UTF-8">
<meta name="generator" content="MediaWiki 1.21.2">







<meta name="ResourceLoaderDynamicStyles" content="">

<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}#toc{display:none}.editsection{display:none}
/* cache key: mwiki1-mwiki_en_:resourceloader:filter:minify-css:7:472787eddcf4605d11de8c7ef047234f */</style>




<style type="text/css">/*<![CDATA[*/
.source-cpp {line-height: normal;}
.source-cpp li, .source-cpp pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for cpp
 * CSS class: source-cpp, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.cpp.source-cpp .de1, .cpp.source-cpp .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.cpp.source-cpp  {font-family:monospace;}
.cpp.source-cpp .imp {font-weight: bold; color: red;}
.cpp.source-cpp li, .cpp.source-cpp .li1 {font-weight: normal; vertical-align:top;}
.cpp.source-cpp .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.cpp.source-cpp .li2 {font-weight: bold; vertical-align:top;}
.cpp.source-cpp .kw1 {color: #0000dd;}
.cpp.source-cpp .kw2 {color: #0000ff;}
.cpp.source-cpp .kw3 {color: #0000dd;}
.cpp.source-cpp .kw4 {color: #0000ff;}
.cpp.source-cpp .co1 {color: #909090;}
.cpp.source-cpp .co2 {color: #339900;}
.cpp.source-cpp .coMULTI {color: #ff0000; font-style: italic;}
.cpp.source-cpp .es0 {color: #008000; font-weight: bold;}
.cpp.source-cpp .es1 {color: #008000; font-weight: bold;}
.cpp.source-cpp .es2 {color: #008000; font-weight: bold;}
.cpp.source-cpp .es3 {color: #008000; font-weight: bold;}
.cpp.source-cpp .es4 {color: #008000; font-weight: bold;}
.cpp.source-cpp .es5 {color: #008000; font-weight: bold;}
.cpp.source-cpp .br0 {color: #008000;}
.cpp.source-cpp .sy0 {color: #008000;}
.cpp.source-cpp .sy1 {color: #000080;}
.cpp.source-cpp .sy2 {color: #000040;}
.cpp.source-cpp .sy3 {color: #000040;}
.cpp.source-cpp .sy4 {color: #008080;}
.cpp.source-cpp .st0 {color: #008000;}
.cpp.source-cpp .nu0 {color: #000080;}
.cpp.source-cpp .nu6 {color: #000080;}
.cpp.source-cpp .nu8 {color: #000080;}
.cpp.source-cpp .nu12 {color: #000080;}
.cpp.source-cpp .nu16 {color:#000080;}
.cpp.source-cpp .nu17 {color:#000080;}
.cpp.source-cpp .nu18 {color:#000080;}
.cpp.source-cpp .nu19 {color:#000080;}
.cpp.source-cpp .ln-xtra, .cpp.source-cpp li.ln-xtra, .cpp.source-cpp div.ln-xtra {background-color: #ffc;}
.cpp.source-cpp span.xtra { display:block; }

/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-text {line-height: normal;}
.source-text li, .source-text pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for text
 * CSS class: source-text, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.text.source-text .de1, .text.source-text .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.text.source-text  {font-family:monospace;}
.text.source-text .imp {font-weight: bold; color: red;}
.text.source-text li, .text.source-text .li1 {font-weight: normal; vertical-align:top;}
.text.source-text .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.text.source-text .li2 {font-weight: bold; vertical-align:top;}
.text.source-text .ln-xtra, .text.source-text li.ln-xtra, .text.source-text div.ln-xtra {background-color: #ffc;}
.text.source-text span.xtra { display:block; }

/*]]>*/
</style><!--[if lt IE 7]><style type="text/css">body{behavior:url("/mwiki/skins/cppreference2/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-cpp_memory_monotonic_buffer_resource skin-cppreference2 action-view cpp-navbar">
        <!-- header -->
        
        <!-- /header -->
        <!-- content -->
<style type="text/css">
#carbonads {
  display: block;
  overflow: hidden;
  position: absolute;
  text-align: center;
  left: -170px;
  max-width: 150px;
  border-radius: 4px;
  border: solid 1px hsla(0, 0%, 0%, .1);
  background-color: hsl(0, 0%, 98%);
  font-size: 12px;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu,
  Cantarell, "Helvetica Neue", Helvetica, Arial, sans-serif;
  line-height: 1.5;
}

#carbonads a {
  color: inherit;
  text-decoration: none;
}

#carbonads a:hover {
  color: inherit;
}

#carbonads span {
  position: relative;
  display: block;
  overflow: hidden;
}

.carbon-img {
  display: block;
  margin-bottom: 8px;
  max-width: 150px;
  line-height: 1;
}

.carbon-img img {
  display: block;
  margin: 0 auto;
  max-width: 150px !important;
  width: 150px;
  height: auto;
}

.carbon-text {
  display: block;
  padding: 0 1em 8px;
}

.carbon-poweredby {
  display: block;
  padding: 8px 12px;
  background: repeating-linear-gradient(-45deg, transparent, transparent 5px, hsla(0, 0%, 0%, .025) 5px, hsla(0, 0%, 0%, .025) 10px) hsla(203, 11%, 95%, .4);
  text-transform: uppercase;
  letter-spacing: .5px;
  font-weight: 600;
  font-size: 9px;
  line-height: 1;
}
html { font-variant-ligatures: no-common-ligatures; }
</style>
        <div id="cpp-content-base">
            <div id="content">
                <a id="top"></a>
                <div id="mw-js-message" style="display:none;"></div>
                                <!-- firstHeading -->
<script async type="text/javascript" src="http://cdn.carbonads.com/carbon.js?serve=CKYITK7M&amp;placement=cppreferencecom" id="_carbonads_js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-8HW0LXMYCY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8HW0LXMYCY');
</script>
                <h1 id="firstHeading" class="firstHeading"><span style="font-size:0.7em; line-height:130%">std::pmr::</span>monotonic_buffer_resource</h1>
                <!-- /firstHeading -->
                <!-- bodyContent -->
                <div id="bodyContent">
                                        <!-- tagline -->
                    
                    <!-- /tagline -->
                                        <!-- subtitle -->
                    
                    <!-- /subtitle -->
                                                            <!-- bodycontent -->
                    <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<table class="t-dcl-begin"><tbody>
<tr class="t-dsc-header">
<td> <div>Defined in header <code><a href="../header/memory_resource.html" title="cpp/header/memory resource">&lt;memory_resource&gt;</a></code>
 </div></td>
<td></td>
<td></td>
</tr>
<tr class="t-dcl t-since-cxx17">
<td> <div><span class="mw-geshi cpp source-cpp"><span class="kw1">class</span> monotonic_buffer_resource <span class="sy4">:</span> <span class="kw1">public</span> <a href="memory_resource.html"><span class="kw712">std::<span class="me2">pmr</span><span class="sy4">::</span><span class="me2">memory_resource</span></span></a><span class="sy4">;</span></span></div></td>
<td class="t-dcl-nopad">  </td>
<td> <span class="t-mark-rev t-since-cxx17">(since C++17)</span> </td>
</tr>
<tr class="t-dcl-sep"><td></td><td></td><td></td></tr>
</tbody></table>
<p>The class <code>std::pmr::monotonic_buffer_resource</code> is a special-purpose memory resource class that releases the allocated memory only when the resource is destroyed. It is intended for very fast memory allocations in situations where memory is used to build up a few objects and then is released all at once.
</p><p><code>monotonic_buffer_resource</code> can be constructed with an initial buffer. If there is no initial buffer, or if the buffer is exhausted, additional buffers are obtained from an <i>upstream memory resource</i> supplied at construction. The size of buffers obtained follows a geometric progression.
</p><p><code>monotonic_buffer_resource</code> is not thread-safe.
</p>
<table id="toc" class="toc"><tbody><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Member_functions"><span class="tocnumber">1</span> <span class="toctext">Member functions</span></a>
<ul>
<li class="toclevel-2"><a href="#Public_member_functions"><span class="tocnumber">1.1</span> <span class="toctext">Public member functions</span></a></li>
<li class="toclevel-2"><a href="#Protected_member_functions"><span class="tocnumber">1.2</span> <span class="toctext">Protected member functions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-2"><a href="#Example"><span class="tocnumber">2</span> <span class="toctext">Example</span></a></li>
</ul>
</td></tr></tbody></table>
<h3><span class="editsection">[<a href="https://en.cppreference.com/mwiki/index.php?title=cpp/memory/monotonic_buffer_resource&amp;action=edit&amp;section=1" title="Edit section: Member functions">edit</a>]</span> <span class="mw-headline" id="Member_functions">Member functions</span></h3>
<table class="t-dsc-begin">

<tbody><tr class="t-dsc">
<td>  <div class="t-dsc-member-div t-dsc-member-nobold-div"><div><a href="monotonic_buffer_resource/monotonic_buffer_resource.html" title="cpp/memory/monotonic buffer resource/monotonic buffer resource"> <span class="t-lines"><span>(constructor)</span></span></a></div></div>
</td>
<td>  constructs a <code>monotonic_buffer_resource</code> <br> <span class="t-mark">(public member function)</span> <span class="editsection noprint plainlinks" title="Edit this template"><a rel="nofollow" class="external text" href="https://en.cppreference.com/mwiki/index.php?title=Template:cpp/memory/monotonic_buffer_resource/dsc_constructor&amp;action=edit">[edit]</a></span>
</td></tr>

<tr class="t-dsc">
<td>  <div class="t-dsc-member-div t-dsc-member-nobold-div"><div><a href="monotonic_buffer_resource/_monotonic_buffer_resource.html" title="cpp/memory/monotonic buffer resource/~monotonic buffer resource"> <span class="t-lines"><span>(destructor)</span></span></a></div><div><span class="t-lines"><span><span class="t-cmark">[virtual]</span></span></span></div></div>
</td>
<td>  destroys a <code>monotonic_buffer_resource</code>, releasing all allocated memory <br> <span class="t-mark">(virtual public member function)</span> <span class="editsection noprint plainlinks" title="Edit this template"><a rel="nofollow" class="external text" href="https://en.cppreference.com/mwiki/index.php?title=Template:cpp/memory/monotonic_buffer_resource/dsc_destructor&amp;action=edit">[edit]</a></span>
</td></tr>

<tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><span class="t-lines"><span>operator=</span></span></div><div><span class="t-lines"><span><span class="t-cmark">[deleted]</span></span></span></div></div>
</td>
<td>  copy assignment operator is deleted. <code>monotonic_buffer_resource</code> is not copy assignable <br> <span class="t-mark">(public member function)</span> <span class="editsection noprint plainlinks" title="Edit this template"><a rel="nofollow" class="external text" href="https://en.cppreference.com/mwiki/index.php?title=Template:cpp/memory/monotonic_buffer_resource/dsc_operator%3D&amp;action=edit">[edit]</a></span>
</td></tr>


<tr>
<td colspan="2"> <h5> <span class="mw-headline" id="Public_member_functions"> Public member functions </span></h5>
</td></tr>

<tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a href="monotonic_buffer_resource/release.html" title="cpp/memory/monotonic buffer resource/release"> <span class="t-lines"><span>release</span></span></a></div></div>
</td>
<td>  release all allocated memory <br> <span class="t-mark">(public member function)</span> <span class="editsection noprint plainlinks" title="Edit this template"><a rel="nofollow" class="external text" href="https://en.cppreference.com/mwiki/index.php?title=Template:cpp/memory/monotonic_buffer_resource/dsc_release&amp;action=edit">[edit]</a></span>
</td></tr>

<tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a href="monotonic_buffer_resource/upstream_resource.html" title="cpp/memory/monotonic buffer resource/upstream resource"> <span class="t-lines"><span>upstream_resource</span></span></a></div></div>
</td>
<td>  returns a pointer to the upstream memory resource <br> <span class="t-mark">(public member function)</span> <span class="editsection noprint plainlinks" title="Edit this template"><a rel="nofollow" class="external text" href="https://en.cppreference.com/mwiki/index.php?title=Template:cpp/memory/monotonic_buffer_resource/dsc_upstream_resource&amp;action=edit">[edit]</a></span>
</td></tr>


<tr>
<td colspan="2"> <h5> <span class="mw-headline" id="Protected_member_functions"> Protected member functions </span></h5>
</td></tr>

<tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a href="monotonic_buffer_resource/do_allocate.html" title="cpp/memory/monotonic buffer resource/do allocate"> <span class="t-lines"><span>do_allocate</span></span></a></div><div><span class="t-lines"><span><span class="t-cmark">[virtual]</span></span></span></div></div>
</td>
<td>  allocate memory <br> <span class="t-mark">(virtual protected member function)</span> <span class="editsection noprint plainlinks" title="Edit this template"><a rel="nofollow" class="external text" href="https://en.cppreference.com/mwiki/index.php?title=Template:cpp/memory/monotonic_buffer_resource/dsc_do_allocate&amp;action=edit">[edit]</a></span>
</td></tr>

<tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a href="monotonic_buffer_resource/do_deallocate.html" title="cpp/memory/monotonic buffer resource/do deallocate"> <span class="t-lines"><span>do_deallocate</span></span></a></div><div><span class="t-lines"><span><span class="t-cmark">[virtual]</span></span></span></div></div>
</td>
<td>  no-op <br> <span class="t-mark">(virtual protected member function)</span> <span class="editsection noprint plainlinks" title="Edit this template"><a rel="nofollow" class="external text" href="https://en.cppreference.com/mwiki/index.php?title=Template:cpp/memory/monotonic_buffer_resource/dsc_do_deallocate&amp;action=edit">[edit]</a></span>
</td></tr>

<tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a href="monotonic_buffer_resource/do_is_equal.html" title="cpp/memory/monotonic buffer resource/do is equal"> <span class="t-lines"><span>do_is_equal</span></span></a></div><div><span class="t-lines"><span><span class="t-cmark">[virtual]</span></span></span></div></div>
</td>
<td>  compare for equality with another <span class="t-lc"><a href="memory_resource.html" title="cpp/memory/memory resource">std::pmr::memory_resource</a></span> <br> <span class="t-mark">(virtual protected member function)</span> <span class="editsection noprint plainlinks" title="Edit this template"><a rel="nofollow" class="external text" href="https://en.cppreference.com/mwiki/index.php?title=Template:cpp/memory/monotonic_buffer_resource/dsc_do_is_equal&amp;action=edit">[edit]</a></span>
</td></tr>
</tbody></table>
<h3><span class="editsection">[<a href="https://en.cppreference.com/mwiki/index.php?title=cpp/memory/monotonic_buffer_resource&amp;action=edit&amp;section=2" title="Edit section: Example">edit</a>]</span> <span class="mw-headline" id="Example">Example</span></h3>
<p>The program measures the time of creating huge double-linked lists using the following allocators:
</p>
<ul><li> default standard allocator,
</li><li> default <code>pmr</code> allocator,
</li><li> <code>pmr</code> allocator with monotonic resource but without explicit memory buffer,
</li><li> <code>pmr</code> allocator with monotonic resource and external memory buffer (on stack).
</li></ul>
<div class="t-example"><div class="t-example-live-link"><div class="coliru-btn coliru-btn-run-init">Run this code</div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1"><span class="co2">#include &lt;array&gt;</span>
<span class="co2">#include &lt;chrono&gt;</span>
<span class="co2">#include &lt;cstddef&gt;</span>
<span class="co2">#include &lt;iomanip&gt;</span>
<span class="co2">#include &lt;iostream&gt;</span>
<span class="co2">#include &lt;list&gt;</span>
<span class="co2">#include &lt;memory_resource&gt;</span>
&nbsp;
<span class="kw1">template</span><span class="sy1">&lt;</span><span class="kw1">typename</span> Func<span class="sy1">&gt;</span>
<span class="kw4">auto</span> benchmark<span class="br0">(</span>Func test_func, <span class="kw4">int</span> iterations<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw4">const</span> <span class="kw4">auto</span> start <span class="sy1">=</span> <a href="../chrono/system_clock/now.html"><span class="kw2692">std::<span class="me2">chrono</span><span class="sy4">::</span><span class="me2">system_clock</span><span class="sy4">::</span><span class="me2">now</span></span></a><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="kw1">while</span> <span class="br0">(</span>iterations<span class="sy2">--</span> <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="br0">)</span>
        test_func<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="kw4">const</span> <span class="kw4">auto</span> stop <span class="sy1">=</span> <a href="../chrono/system_clock/now.html"><span class="kw2692">std::<span class="me2">chrono</span><span class="sy4">::</span><span class="me2">system_clock</span><span class="sy4">::</span><span class="me2">now</span></span></a><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="kw4">const</span> <span class="kw4">auto</span> secs <span class="sy1">=</span> <a href="../chrono/duration.html"><span class="kw996">std::<span class="me2">chrono</span><span class="sy4">::</span><span class="me2">duration</span></span></a><span class="sy1">&lt;</span><span class="kw4">double</span><span class="sy1">&gt;</span><span class="br0">(</span>stop <span class="sy2">-</span> start<span class="br0">)</span><span class="sy4">;</span>
    <span class="kw1">return</span> secs.<span class="me1">count</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
&nbsp;
<span class="kw4">int</span> main<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw4">constexpr</span> <span class="kw4">int</span> iterations<span class="br0">{</span><span class="nu0">100</span><span class="br0">}</span><span class="sy4">;</span>
    <span class="kw4">constexpr</span> <span class="kw4">int</span> total_nodes<span class="br0">{</span><span class="nu0">2</span><span class="st0">'00'</span><span class="nu8">000</span><span class="br0">}</span><span class="sy4">;</span>
&nbsp;
    <span class="kw4">auto</span> default_std_alloc <span class="sy1">=</span> <span class="br0">[</span>total_nodes<span class="br0">]</span>
    <span class="br0">{</span>
        <a href="../container/list.html"><span class="kw1282">std::<span class="me2">list</span></span></a><span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> list<span class="sy4">;</span>
        <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i<span class="br0">{</span><span class="br0">}</span><span class="sy4">;</span> i <span class="sy3">!</span><span class="sy1">=</span> total_nodes<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">)</span>
            list.<span class="me1">push_back</span><span class="br0">(</span>i<span class="br0">)</span><span class="sy4">;</span>
    <span class="br0">}</span><span class="sy4">;</span>
&nbsp;
    <span class="kw4">auto</span> default_pmr_alloc <span class="sy1">=</span> <span class="br0">[</span>total_nodes<span class="br0">]</span>
    <span class="br0">{</span>
        <a href="../container/list.html"><span class="kw1283">std::<span class="me2">pmr</span><span class="sy4">::</span><span class="me2">list</span></span></a><span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> list<span class="sy4">;</span>
        <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i<span class="br0">{</span><span class="br0">}</span><span class="sy4">;</span> i <span class="sy3">!</span><span class="sy1">=</span> total_nodes<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">)</span>
            list.<span class="me1">push_back</span><span class="br0">(</span>i<span class="br0">)</span><span class="sy4">;</span>
    <span class="br0">}</span><span class="sy4">;</span>
&nbsp;
    <span class="kw4">auto</span> pmr_alloc_no_buf <span class="sy1">=</span> <span class="br0">[</span>total_nodes<span class="br0">]</span>
    <span class="br0">{</span>
        std<span class="sy4">::</span><span class="me2">pmr</span><span class="sy4">::</span><span class="me2">monotonic_buffer_resource</span> mbr<span class="sy4">;</span>
        <a href="polymorphic_allocator.html"><span class="kw711">std::<span class="me2">pmr</span><span class="sy4">::</span><span class="me2">polymorphic_allocator</span></span></a><span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> pa<span class="br0">{</span><span class="sy3">&amp;</span>mbr<span class="br0">}</span><span class="sy4">;</span>
        <a href="../container/list.html"><span class="kw1283">std::<span class="me2">pmr</span><span class="sy4">::</span><span class="me2">list</span></span></a><span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> list<span class="br0">{</span>pa<span class="br0">}</span><span class="sy4">;</span>
        <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i<span class="br0">{</span><span class="br0">}</span><span class="sy4">;</span> i <span class="sy3">!</span><span class="sy1">=</span> total_nodes<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">)</span>
            list.<span class="me1">push_back</span><span class="br0">(</span>i<span class="br0">)</span><span class="sy4">;</span>
    <span class="br0">}</span><span class="sy4">;</span>
&nbsp;
    <span class="kw4">auto</span> pmr_alloc_and_buf <span class="sy1">=</span> <span class="br0">[</span>total_nodes<span class="br0">]</span>
    <span class="br0">{</span>
        <a href="../container/array.html"><span class="kw1275">std::<span class="me2">array</span></span></a><span class="sy1">&lt;</span><a href="../types/byte.html"><span class="kw2658">std::<span class="me2">byte</span></span></a>, total_nodes <span class="sy2">*</span> <span class="nu0">32</span><span class="sy1">&gt;</span> buffer<span class="sy4">;</span> <span class="co1">// enough to fit in all nodes</span>
        std<span class="sy4">::</span><span class="me2">pmr</span><span class="sy4">::</span><span class="me2">monotonic_buffer_resource</span> mbr<span class="br0">{</span>buffer.<span class="me1">data</span><span class="br0">(</span><span class="br0">)</span>, buffer.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="br0">}</span><span class="sy4">;</span>
        <a href="polymorphic_allocator.html"><span class="kw711">std::<span class="me2">pmr</span><span class="sy4">::</span><span class="me2">polymorphic_allocator</span></span></a><span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> pa<span class="br0">{</span><span class="sy3">&amp;</span>mbr<span class="br0">}</span><span class="sy4">;</span>
        <a href="../container/list.html"><span class="kw1283">std::<span class="me2">pmr</span><span class="sy4">::</span><span class="me2">list</span></span></a><span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> list<span class="br0">{</span>pa<span class="br0">}</span><span class="sy4">;</span>
        <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i<span class="br0">{</span><span class="br0">}</span><span class="sy4">;</span> i <span class="sy3">!</span><span class="sy1">=</span> total_nodes<span class="sy4">;</span> <span class="sy2">++</span>i<span class="br0">)</span>
            list.<span class="me1">push_back</span><span class="br0">(</span>i<span class="br0">)</span><span class="sy4">;</span>
    <span class="br0">}</span><span class="sy4">;</span>
&nbsp;
    <span class="kw4">const</span> <span class="kw4">double</span> t1 <span class="sy1">=</span> benchmark<span class="br0">(</span>default_std_alloc, iterations<span class="br0">)</span><span class="sy4">;</span>
    <span class="kw4">const</span> <span class="kw4">double</span> t2 <span class="sy1">=</span> benchmark<span class="br0">(</span>default_pmr_alloc, iterations<span class="br0">)</span><span class="sy4">;</span>
    <span class="kw4">const</span> <span class="kw4">double</span> t3 <span class="sy1">=</span> benchmark<span class="br0">(</span>pmr_alloc_no_buf , iterations<span class="br0">)</span><span class="sy4">;</span>
    <span class="kw4">const</span> <span class="kw4">double</span> t4 <span class="sy1">=</span> benchmark<span class="br0">(</span>pmr_alloc_and_buf, iterations<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <a href="../io/cout.html"><span class="kw1774">std::<span class="me2">cout</span></span></a> <span class="sy1">&lt;&lt;</span> <a href="../io/manip/fixed.html"><span class="kw1800">std::<span class="me2">fixed</span></span></a> <span class="sy1">&lt;&lt;</span> <a href="../io/manip/setprecision.html"><span class="kw1812">std::<span class="me2">setprecision</span></span></a><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span>
              <span class="sy1">&lt;&lt;</span> <span class="st0">"t1 (default std alloc): "</span> <span class="sy1">&lt;&lt;</span> t1 <span class="sy1">&lt;&lt;</span> <span class="st0">" sec; t1/t1: "</span> <span class="sy1">&lt;&lt;</span> t1<span class="sy2">/</span>t1 <span class="sy1">&lt;&lt;</span> <span class="st0">'<span class="es1">\n</span>'</span>
              <span class="sy1">&lt;&lt;</span> <span class="st0">"t2 (default pmr alloc): "</span> <span class="sy1">&lt;&lt;</span> t2 <span class="sy1">&lt;&lt;</span> <span class="st0">" sec; t1/t2: "</span> <span class="sy1">&lt;&lt;</span> t1<span class="sy2">/</span>t2 <span class="sy1">&lt;&lt;</span> <span class="st0">'<span class="es1">\n</span>'</span>
              <span class="sy1">&lt;&lt;</span> <span class="st0">"t3 (pmr alloc  no buf): "</span> <span class="sy1">&lt;&lt;</span> t3 <span class="sy1">&lt;&lt;</span> <span class="st0">" sec; t1/t3: "</span> <span class="sy1">&lt;&lt;</span> t1<span class="sy2">/</span>t3 <span class="sy1">&lt;&lt;</span> <span class="st0">'<span class="es1">\n</span>'</span>
              <span class="sy1">&lt;&lt;</span> <span class="st0">"t4 (pmr alloc and buf): "</span> <span class="sy1">&lt;&lt;</span> t4 <span class="sy1">&lt;&lt;</span> <span class="st0">" sec; t1/t4: "</span> <span class="sy1">&lt;&lt;</span> t1<span class="sy2">/</span>t4 <span class="sy1">&lt;&lt;</span> <span class="st0">'<span class="es1">\n</span>'</span><span class="sy4">;</span>
<span class="br0">}</span></pre></div></div>
<p>Possible output:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="text source-text"><pre class="de1">t1 (default std alloc): 0.720 sec; t1/t1: 1.000
t2 (default pmr alloc): 0.915 sec; t1/t2: 0.787
t3 (pmr alloc  no buf): 0.370 sec; t1/t3: 1.945
t4 (pmr alloc and buf): 0.247 sec; t1/t4: 2.914</pre></div></div> 
</div>

<!-- 
NewPP limit report
Preprocessor visited node count: 9972/1000000
Preprocessor generated node count: 12727/1000000
Post‐expand include size: 329223/4194304 bytes
Template argument size: 71844/4194304 bytes
Highest expansion depth: 23/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mwiki1-mwiki_en_:pcache:idhash:14968-0!*!0!!en!*!* and timestamp 20250113084123 -->
</div>                    <!-- /bodycontent -->
                                        <!-- printfooter -->
                    <div class="printfooter">
                    Retrieved from "<a href="https://en.cppreference.com/mwiki/index.php?title=cpp/memory/monotonic_buffer_resource&amp;oldid=152966">https://en.cppreference.com/mwiki/index.php?title=cpp/memory/monotonic_buffer_resource&amp;oldid=152966</a>"                    </div>
                    <!-- /printfooter -->
                                                            <!-- catlinks -->
                    <div id="catlinks" class="catlinks catlinks-allhidden"></div>                    <!-- /catlinks -->
                                                            <div class="visualClear"></div>
                    <!-- debughtml -->
                                        <!-- /debughtml -->
                </div>
                <!-- /bodyContent -->
            </div>
        </div>
        <!-- /content -->
        <!-- footer -->
        
        <!-- /footer -->
        <script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script src="https://en.cppreference.com/mwiki/load.php?debug=false&amp;lang=en&amp;modules=skins.cppreference2&amp;only=scripts&amp;skin=cppreference2&amp;*"></script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest","mediawiki.hidpi","ext.gadget.ColiruCompiler","ext.gadget.StandardRevisions","ext.gadget.MathJax"], null, true);
}</script>
<script src="https://en.cppreference.com/mwiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=cppreference2&amp;*"></script>
<!-- Served in 1.294 secs. -->
	




</body><!-- Cached 20250113084123 --><!-- Mirrored from en.cppreference.com/w/cpp/memory/monotonic_buffer_resource by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 29 Jan 2025 11:38:23 GMT --></html>